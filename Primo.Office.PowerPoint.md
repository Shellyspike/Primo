# Primo.Office.PowerPoint

**Primo.Office.PowerPoint** — это библиотека, которая позволяет автоматизировать задачи создания и редактирования презентаций в формате MS PowerPoint. 

## Общие сведения

**Primo.Office.PowerPoint**  предоставляет удобный интерфейс для автоматизации процессов, связанных с презентациями. Библиотека поддерживает создание, редактирование и управление слайдами, а также взаимодействие с различными мультимедийными элементами и объектами.

## Инструкции по началу работы

Чтобы установить пакет **Primo.Office.PowerPoint**, воспользуйтесь Менеджером зависимостей в Primo RPA Studio или посетите [NuGet.org](https://www.nuget.org/).

### Шаги для установки

1. **Откройте Менеджер зависимостей:**
   - В главном меню Primo RPA Studio выберите `Управление зависимостями`.
   - Либо щелкните правой кнопкой мыши в панели проекта и выберите в появившемся меню пункт «Зависимости».

2. В открывшемся окне перейдите в раздел **NuGet.org** и введите **Primo.Office.PowerPoint** в строку поиска.

3. Нажмите на значок фильтра для отображения списка доступных библиотек. Найдите **Primo.Office.PowerPoint** и нажмите **Установить**.

4. Нажмите **Сохранить**. 

5. В открывшемся модальном окне нажмите **Установить**, а затем **Закрыть** для завершения установки. Пакет будет добавлен в ваш проект.

## Документация

Для более подробной информации о настройке и использовании **Primo.Office.PowerPoint** посетите [документацию на нашем сайте](https://docs.primo-rpa.ru/primo-rpa/g_elements/el_extra/els_powerpoint).

## Функциональность библиотеки

Библиотека включает в себя следующие основные элементы:

- Приложение PowerPoint
- Вставить медиа-файл
- Вставить объект
- Вставить таблицу
- Вставить текст
- Вставить файл
- Добавить слайд
- Заменить текст
- Запустить макрос
- Копировать-вставить слайд
- Редактировать фигуру
- Удалить слайд
- Сохранить документ

## Примеры использования Primo.Office.PowerPoint

### Вставка медиа-файла

```csharp
app.AddMedia(1, "Shape1", "C:\\file.avi", 10, 20, 100, 50);
```

### Вставка объекта

```csharp
app.PasteItem(1, "Shape1", 10, 20, 100, 50);
```

### Вставка таблицы

```csharp
app.AddDataTable(1, "Shape1", tbl, true, Primo.Office.PowerPoint.Model.AddTableTypes.CreateNewTable, 2, 3);
```

### Вставка текста

```csharp
app.AddText(1, "Shape1", "text", false);
```

### Вставка файла

```csharp
app.AddFile(1, "Shape1", "C:\\file.txt", "File title");
```

### Добавление слайда

```csharp
int newidx = app.AddNewSlide(1, "LayoutText", "Default");
```

### Замена текста

```csharp
int cnt = app.AddFile("old text", "new text", true, true, false);
```

### Запуск макроса

```csharp
object res = app.RunMacro("mscro1", new List<object>() { 10 });
```

### Сохранение документа

```csharp
app.Save();
app.SaveAs("C:\\file.pptx");
```

### Удаление слайда

```csharp
app.DeleteSlide(4);
```

## Свойства элементов библиотеки

### Общие

Раздел **Общие** есть у каждого элемента, в него входят следующие свойства:

- Наименование
- Отключение логирования
- Пауза до/после
- Продолжение при ошибке
- Скриншот завершения
- Скриншот ошибки
- Тайм-аут

С описанием общих свойств можно ознакомиться на нашем сайте [здесь](https://docs.primo-rpa.ru/primo-rpa/primo-rpa-studio/process/elements).

### Элемент "Приложение PowerPoint"

Все перечисленные ниже компоненты добавляются в рабочую область внутри элемента **Приложение PowerPoint**. Это компонент, производящий подключение к приложению PowerPoint. В случае отсутствия указанного файла, будет создан новый. Элемент **Приложение PowerPoint** включает в себя следующие свойства:

- **Массив байтов**: Массив байтов документа.
- **Путь к файлу**: По кнопке ![alt text](image-3.png) можно указать путь к файлу в окне Проводника.

### Элемент "Вставить медиа-файл"

Производит вставку медиа-файла в презентацию. Включает в себя следующие свойства:

1. **PowerPoint**:
   - Индекс слайда
   - Файл – путь к файлу.
   - Фигура – имя фигуры для вставки.
2. **Координаты**:
   - Высота
   - Сверху – отступ сверху.
   - Слева – отступ слева.
   - Ширина

### Элемент "Вставить объект"

Производит вставку объекта в презентацию. Включает в себя следующие свойства:

1. **PowerPoint**:
   - Индекс слайда
   - Фигура – имя фигуры для вставки.
2. **Координаты**:
   - Высота
   - Сверху – отступ сверху.
   - Слева – отступ слева.
   - Ширина

### Элемент "Вставить таблицу"

Производит вставку таблицы в презентацию. Включает в себя следующие свойства:

1. **PowerPoint**:
   - Индекс слайда
   - Исключить заголовки – не включать заголовки в таблицу.
   - Перезаписать с колонки – перезаписывать начиная с колонки.
   - Перезаписать со строки – перезаписывать начиная со строки.
   - Режим – режим вставки данных.
   - Таблица – таблица данных для вставки.
   - Фигура – имя фигуры для вставки.

### Элемент "Вставить текст"

Производит вставку текста в презентацию. Включает в себя следующие свойства:

1. **PowerPoint**:
   - Индекс слайда
   - Фигура – имя фигуры для вставки.
   - Текст
   - Очищать – очищать имеющийся текст.

### Элемент "Вставить файл"

Производит вставку файла в презентацию. Включает в себя следующие свойства:

1. **PowerPoint**:
   - Заголовок – заголовок иконки файла.
   - Индекс слайда
   - Файл – путь к файлу.
   - Фигура – имя фигуры для вставки.

### Элемент "Добавить слайд"

Добавляет новый слайд в презентацию. Включает в себя следующие свойства:

1. **PowerPoint**:
   - Дизайн – дизайн слайда.
   - Индекс – индекс вставки. Если не указан, добавляется в конец
   - Тема – тема оформления слайда.
2. **Вывод**:
   - Новый индекс – индекс нового слайда.

### Элемент "Заменить текст"

Производит замену текста в презентации. Включает в себя следующие свойства:

1. **PowerPoint**:
   - Замена – обязательно для заполнения. Текст на замену.
   - Заменить все – заменить все вхождения текста
   - Исходный текст – обязательно для заполнения.
   - Регистр – учитывать регистр.
   - Слова целиком – заменять только слова целиком.
2. **Вывод**:
   - Кол-во изменений

### Элемент "Запустить макрос"

Выполняет макрос PowerPoint. Включает в себя следующие свойства:

1. **PowerPoint** (обязательны для заполнения):
   - Аргументы – аргументы макроса.
   - Наименование – наименование макроса.
2. **Вывод**:
   - Результат

### Элемент "Копировать-вставить слайд"

Производит копирование-вставку слайда в презентацию. Включает в себя следующие свойства:

1. **PowerPoint**:
   - Индекс слайда
   - Индекс слайда назначения
   - Перенос – осуществить перенос слайда.
   - Файл назначения – путь к файлу.

### Элемент "Редактировать фигуру"

Производит редактирование фигуры презентации. Включает в себя следующие свойства:

1. **PowerPoint** (обязательны для заполнения):
   - Индекс слайда
   - Фигура – имя фигуры для редактирования
2. **Слои**:
   - Менять положение – признак изменения положения в слоях.
   - Тип положения – тип изменения положения в слоях.
3. **Шрифт**:
   - Размер

### Элемент "Сохранить документ"

Производит сохранения файла PowerPoint. Если путь к файлу не указан, сохранен будет файл, открытый в рамках текущего контейнера PowerPoint. Включает в себя следующие свойства:

1. **Прочее**:
   - Путь к файлу

### Элемент "Удалить слайд"

Удаляет слайд из презентации. Включает в себя следующие свойства:

1. **PowerPoint**:
   - Индекс – индекс слайда. Если не указан, удаляет последний.

## Обратная связь

Если у вас возникли вопросы или предложения, пожалуйста, свяжитесь с нами по адресу [support@primo-rpa.ru](mailto:support@primo-ru)
