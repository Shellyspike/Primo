# Описание пакета Primo.Office.MyOffice

Пакет **Primo.Office.MyOffice** предоставляет инструменты для автоматизации работы с документами офисного пакета Р7. Он позволяет выполнять действия с текстовыми и табличными документами, включая ввод данных, форматирование и управление структурой документов.

## Общие сведения

**Primo.Office.MyOffice** — это библиотека, предназначенная для взаимодействия с документами в приложениях Р7. Пакет поддерживает автоматизацию работы с текстовыми и табличными файлами, предоставляя удобный интерфейс для выполнения различных операций, таких как ввод данных, изменение структуры документа, выполнение макросов и многое другое.

## Инструкции по началу работы

Чтобы установить пакет **Primo.Office.MyOffice**, воспользуйтесь Менеджером зависимостей в Primo RPA Studio или посетите [NuGet.org](https://www.nuget.org/).

### Шаги для установки

1. **Откройте Менеджер зависимостей:**
   - В главном меню Primo RPA Studio выберите `Управление зависимостями`.
   - Или щелкните правой кнопкой в панели проекта и выберите в отобразившемся меню пункт «Зависимости».

2. В открывшемся окне перейдите в раздел **NuGet.org** и введите **Primo RPA** в строку поиска.

3. Нажмите на значок с воронкой для отображения списка доступных библиотек. Найдите **Primo.Office.MyOffice** и нажмите **Установить**.

4. Нажмите **Сохранить**. 

5. В открывшемся модальном окне нажмите **Установить** и затем **Закрыть** для завершения установки. Пакет будет добавлен в ваш проект.

6. После установки библиотеки в панели элементов появятся группы **Р7-Таблицы** и **Р7-Документы**.

## Документация

Для более подробной информации о настройке и использовании **Primo.Office.MyOffice** посетите [документацию на нашем сайте](https://docs.primo-rpa.ru).

## Состав библиотеки

Библиотека включает в себя следующие возможности:

- **Р7-Таблицы**:
   - Страницы
      - Добавить страницу
      - Переименовать страницу
      - Список страниц
      - Удалить страницу
   - Запись диапазона
   - Запустить макрос
   - Запустить скрипт
   - Изменение цвета фона
   - Изменение ячейки
   - Сохранить документ
   - Таблица Р7 
   - Удаление диапазона
   - Чтение диапазона

- **Р7-Документы**:
  - Ввод текста
  - Документ Р7
  - Заменить текст
  - Запустить макрос
  - Запустить скрипт
  - Сохранить документ
  - Удалить текст
  - Чтение текста

Для использования элемента необходимо перетащить его в рабочее поле проекта Primo RPA Studio.

## Свойства элементов библиотеки

### Общие

Раздел **Общие** есть у каждого элемента, в него входят следующие свойства:

- Наименование
- Отключение логирования
- Пауза до/после
- Продолжение при ошибке
- Скриншот завершения
- Скриншот ошибки
- Тайм-аут

С описанием общих свойств можно ознакомиться на нашем сайте [здесь](https://docs.primo-rpa.ru/primo-rpa/primo-rpa-studio/process/elements).

### Раздел "Р7-Таблицы"

Все перечисленные ниже элементы добавляются в рабочую область внутри элемента **Таблица Р7**. Это элемент для подключения к приложению "Р7". Если указанный файл отсутствует, будет создан новый. Элемент **Таблица Р7** включает в себя следующие свойства:

1. **Таблица**
   - Имя файла – имя файла документа Р7.
   - Тайм-аут – тайм-аут запроса в секундах.

---

#### Подраздел "Страницы"

   ##### Добавить страницу
   
   Элемент для добавления новой страницы в Таблицу. Включает в себя следующие свойства:
   
   1. **Таблица**:
      - Имя — Имя новой страницы. Обязательно для заполнения.
      - Индекс — Индекс страницы.
   
   ##### Переименовать страницу
   
   Элемент для переименования страницы в Таблице. Включает в себя следующие свойства:
   
   1. **Таблица** (обязательно для заполнения):
      - Имя — Имя страницы.
      - Индекс — Индекс страницы.
   
   ##### Список страниц
   
   Элемент для получения списка страниц Таблицы. Включает в себя следующие свойства:
   
   1. **Вывод**:
      - Переменная — переменная для хранения списка страниц.
   
   ##### Удалить страницу
   
   Элемент для удаления страницы из Таблицы. Включает в себя следующие свойства:
   
   1. **Таблица** (обязательно для заполнения):
      - Индекс — Индекс страницы.
     
---

#### Элемент "Запись диапазона"

Элемент, записывающий данные диапазона ячеек в Таблицу. Включает в себя следующие свойства:

1. **Таблица**:
   - Диапазон — диапазон записи ячеек (A1:D12).
   - Добавлять заголовки — добавлять заголовки колонок таблицы.
   - Индекс страницы
   - Направление — направление сдвига ячеек:
     - Down
     - Right
   - Перезаписать — признак перезаписи данных.
   - Переменная (таблица) — переменная для хранения данных текстовых значений.
   - Переменная (текст) — переменная для хранения данных записи текстовых значений.
   - Расширять диапазон — автоматически расширять диапазон до размеров данных.
   - Страница — наименование страницы.

#### Элемент "Запустить макрос"

Элемент для выполнения макроса таблицы. Включает в себя следующие свойства:

1. **Вывод**:
   - Результат — результат выполнения.
2. **Таблица**:
   - Аргументы — аргументы макроса.
   - Имя — имя макроса. Обязательно для заполнения.

#### Элемент "Запустить скрипт"

Элемент для выполнения скрипта таблицы. Включает в себя следующие свойства:

1. **Вывод**:
   - Результат — результат выполнения.
2. **Таблица**:
   - Аргументы — аргументы скрипта.
   - Текст — текст скрипта. Обязательно для заполнения.

#### Элемент "Изменение цвета фона"

Изменяет цвет фона диапазона таблицы. Включает в себя следующие свойства:

1. **Таблица**:
   - Диапазон — диапазон ячеек (A1:D12). Обязательно для заполнения.
   - Индекс страницы
   - Страница — название страницы.
   - Цвет фона — цвет фона диапазона, например `System.Drawing.Color.Black`.

#### Элемент "Изменение ячейки"

Изменяет формат ячеек таблицы. Включает в себя следующие свойства:

1. **Таблица**:
   - Диапазон — диапазон ячеек (A1:D12). Обязательно для заполнения.
   - Индекс страницы
   - Страница — название страницы.
   - Тип бордюра — тип бордюра ячеек.
   - Толщина бордюра — толщина бордюра ячеек.
   - Цвет бордюра — цвет бордюра ячеек диапазона.
   - Цвет ячеек — цвет ячеек диапазона.

#### Элемент "Чтение диапазона"

Элемент считывает данные из диапазона ячеек таблицы. Включает в себя следующие свойства:

1. **Вывод**:
   - Переменная (таблица) — переменная для хранения результатов чтения текстовых значений.
   - Переменная (текст) — переменная для хранения результатов чтения текстовых значений.
   - Строка заголовков — признак того, что первая строка содержит заголовки (для таблицы). Если галочка установлена, то заголовки будут учитываться.
2. **Таблица**:
   - Диапазон — диапазон считывания ячеек ("A1:D12"). Если не указан, будет прочитан выделенный диапазон. Если указан символ "*", будет прочитан весь лист.
   - Индекс страницы
   - Страница — наименование страницы.

#### Элемент "Удаление диапазона"

Элемент удаляет диапазон ячеек таблицы. Включает в себя следующие свойства:

1. **Таблица**:
   - Диапазон — диапазон считывания ячеек ("A1:D12"). Если не указан, будет прочитан выделенный диапазон. Если указан символ "*", будет прочитан весь лист. Обязательно для заполнения.
   - Индекс страницы
   - Сдвиг — направление сдвига.
   - Страница — наименование страницы.

#### Элемент "Сохранить документ"

Элемент сохраняет файл таблицы.

### Раздел "Р7-Документы"

Все перечисленные ниже элементы добавляются в рабочую область внутри элемента **Документ Р7**. Этот контейнер производит подключение к приложению Р7. Если указанный файл отсутствует, будет создан новый. Элемент **Документ Р7** включает в себя следующие свойства:

1. **Таблица**:
   - Тайм-аут — тайм-аут запроса в секундах. Обязательно для заполнения.
2. **Текст**:
   - Имя файла — имя файла документа. Обязательно для заполнения.

#### Элемент "Ввод текста"

Элемент записывает данные в текстовый документ. Включает в себя следующие свойства:

1. **Текст**:
   - Закладка — имя закладки, определяющей начало записи. Если не указано, запись производится в конец текста.
   - Начало — индекс начала вставки.
   - Текст — данные, вводимые в документ. Обязательно для заполнения.

#### Элемент "Заменить текст"

Элемент заменяет все вхождения исходного текста на новый. Включает в себя следующие свойства:

1. **Текст**:
   - Исходный текст — текст, подлежащий замене.
   - Новый текст — новый текст для замены. Обязательно для заполнения.

#### Элемент "Запустить макрос"

Элемент для выполнения макроса документа. Включает в себя следующие свойства:

1. **Вывод**:
   - Результат — результат выполнения.
2. **Таблица**:
   - Аргументы — аргументы макроса.
   - Имя — имя макроса. Обязательно для заполнения.

#### Элемент "Запустить скрипт"

Элемент для выполнения скрипта документ. Включает в себя следующие свойства:

1. **Вывод**:
   - Результат — результат выполнения.
2. **Таблица**:
   - Аргументы — аргументы скрипта.
   - Текст — текст скрипта. Обязательно для заполнения.

#### Элемент "Чтение текста"

Элемент считывает данные из документа. Включает в себя следующие свойства:

1. **Текст**:
   - Длина – длина выделения.
   - Начало – начало выделения.
   - Переменная – переменная для хранения результатов чтения. Обязательно для заполнения.

#### Элемент "Удалить текст"

Удаляет текст заданной длины. Если ни начало, ни длина не указаны, удаляется весь текст. Включает в себя следующие свойства:

1. **Текст**:
   - Длина – длина выделения.
   - Начало – начало выделения.

#### Элемент "Сохранить документ"

Элемент сохраняет файл.

## Обратная связь

Если у вас возникли вопросы или предложения, пожалуйста, свяжитесь с нами по адресу [support@primo-rpa.ru](mailto:support@primo-rpa.ru).
