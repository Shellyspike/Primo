# Primo.Database.SqlServer.Linux

**Primo.Database.SqlServer.Linux** — это библиотека, предназначенная для упрощения работы с базами данных MS SQL Server в среде Linux. Пакет решает задачи, связанные с выполнением SQL-запросов и управлением подключениями к базе данных, предоставляя разработчикам удобный и интуитивно понятный интерфейс.

## Установка и настройка

Для установки пакета **Primo.Database.SqlServer.Linux** воспользуйтесь Менеджером зависимостей Visual Studio или загрузите его с [NuGet.org](https://www.nuget.org/).

### Установка через Менеджер зависимостей:

1. **Откройте Менеджер зависимостей:**
   - В главном меню Primo RPA Studio выберите `Управление зависимостями`.
   - Или щелкните правой кнопкой в панели проекта и выберите в отобразившемся меню пункт «Зависимости».

2. В открывшемся окне перейдите в раздел **NuGet.org** и введите **Primo RPA** в строку поиска.

3. Нажмите на значок с воронкой для отображения списка доступных библиотек. Найдите **Primo.Database.SqlServer.Linux** и нажмите **Установить**.

4. Нажмите **Сохранить**.

5. В открывшемся модальном окне нажмите **Установить** и затем **Закрыть** для завершения установки. Пакет будет добавлен в ваш проект.для завершения установки. Пакет будет добавлен в ваш проект.

## Документация

Более подробная документация доступна на [сайте Primo RPA](https://docs.primo-rpa.ru).

## Возможности и функции

С помощью предоставляемых библиотекой элементов можно выполнять следующие основные функции:

- **Выполнение SQL-запросов** с использованием элемента **"Выполнить запрос к базе данных"**.
- **Управление подключениями**: возможность использовать существующие подключения или настраивать новые через свойства элементов с помощью **"Присоединиться к БД"** и **"Отсоединиться от БД"**.
- **Вставка данных** в базу данных с использованием элемента **"Вставка данных"**, что позволяет быстро добавлять новые записи в таблицы.

## Состав библиотеки

### Общие

Раздел **Общие** есть у каждого элемента, в него входят следующие свойства:

- Наименование
- Отключение логирования
- Пауза до/после
- Продолжение при ошибке
- Скриншот завершения
- Скриншот ошибки
- Тайм-аут

С описанием общих свойств можно ознакомиться на нашем сайте [здесь](https://docs.primo-rpa.ru/primo-rpa/primo-rpa-studio/process/elements).

### Свойства элемента «Присоединиться к БД»

Элемент осуществляет подключение к базе данных (БД). Установленное соединение обеспечивает возможность передачи запросов и получения ответов между приложением и базой данных.

1. **База данных**:
   - Строка соединения: Обязательно для заполнения. Строка подключения, которая будет использована для установки подключения к базе данных. 

2. **Вывод**:
   - Соединение с БД: Экземпляр соединения с БД. Позволяет сохранить активное соединение в переменную, чтобы использовать в других местах сценария для более быстрого подключения или отключения от БД.

### Свойства элемента «Вставка данных»

Элемент производит вставку данных в указанную таблицу базы данных (БД).

1. **База данных**:
   - Соединение с БД: Обязательное поле. Переменная, содержащая экземпляр соединения с БД. Если это поле заполнено, оставьте пустым поле «Строка соединения».
   - Строка соединения: Строка подключения, которая будет использована для установки подключения к базе данных. 

2. **Вывод**:
   - Кол-во: Количество обработанных строк.

3. **Данные запроса**:
   - Данные: Обязательно для заполнения. Данные в виде таблицы. Укажите название переменной.
   - Таблица: Обязательно для заполнения. Название таблицы в БД, в которую вы хотите вставить данные
   - Таймаут: Обязательно для заполнения. Таймаут запроса в секундах.

### Свойства элемента «Выполнить запрос»

Элемент выполняет запрос к базе данных (БД).

1. **База данных**:
   - Соединение с БД: Переменная, содержащая экземпляр соединения с БД. Заполняется, если вы хотите использовать ранее установленное и активное подключение. Если это поле заполнено, оставьте пустым поле «Строка соединения».
   - Строка соединения: Строка подключения, которая будет использована для установки подключения к базе данных. 

2. **Вывод**:
   - Кол-во: Количество обработанных строк.
   - Переменная (массив): Переменная для сохранения результатов запроса в массиве.
   - Переменная (таблица): Переменная для сохранения результатов запроса в `DataTable`.

3. **Данные запроса**:
   - Аргументы (конструктор): Аргументы запроса в строковом формате. Строку можно сформировать в окне мастера по кнопке ![alt text](image-1.png). Пример результата из мастера:
     ```plaintext
     "{\"Args\":[{\"Position\":0,\"Name\":\"@par1\",\"Script\":\"\\\"test\\\"\"}]}"
     ```
   - Аргументы (массив): Аргументы запроса в виде массива.
   - Наличие результатов: Признак ожидания результатов запроса. Установите галочку, если запрос должен вернуть данные (например, `SELECT * FROM table`). Если это запрос типа `INSERT INTO` или `DELETE FROM`, который не возвращает данные, галочку ставить не нужно.
   - Таймаут: Таймаут запроса в секундах. Обязательно для заполнения.
   - Текст запроса: Обязательно для заполнения. Текст SQL-запроса. Пример для PostgreSQL:
     ```sql
     "SELECT * FROM table1 WHERE column1 = @par1"
     ```

### Свойства элемента «Отсоединиться от БД»

Элемент завершает соединение с базой данных.

1. **База данных**:
   - Соединение с БД: Обязательно для заполнения. Переменная, содержащая экземпляр соединения с БД.

## Обратная связь

Если у вас возникли вопросы или предложения, пожалуйста, свяжитесь с нами по адресу [support@primo-rpa.ru](mailto:support@primo-rpa.ru).
