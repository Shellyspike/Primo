# Описание пакета Primo.ActiveDirectory

Пакет **Primo.ActiveDirectory** предоставляет набор элементов для взаимодействия с доменными службами Active Directory - создание, удаление и конфигурирование пользователей, групп и компьютеров.

## Общие сведения

**Primo.ActiveDirectory** — это мощный инструмент для взаимодействия с Active Directory, позволяющий автоматизировать управление учетными записями пользователей, компьютеров и групп. Библиотека предоставляет удобный интерфейс для выполнения задач администрирования, включая создание, удаление и изменение свойств объектов в доменной среде.

## Инструкции по началу работы

Чтобы установить пакет **Primo.ActiveDirectory**, воспользуйтесь Менеджером зависимостей в Primo RPA Studio или посетите [NuGet.org](https://www.nuget.org/).

### Шаги для установки

1. **Откройте Менеджер зависимостей:**
   - В главном меню Primo RPA Studio выберите `Управление зависимостями`.
   - Или щелкните правой кнопкой в панели проекта и выберите в отобразившемся меню пункт «Зависимости».

2. В открывшемся окне перейдите в раздел **NuGet.org** и введите **Primo RPA** в строку поиска.

3. Нажмите на значок с воронкой для отображения списка доступных библиотек. Найдите **Primo.ActiveDirectory** и нажмите **Установить**.

4. Нажмите **Сохранить**. 

5. В открывшемся модальном окне нажмите **Установить** и затем **Закрыть** для завершения установки. Пакет будет добавлен в ваш проект.

## Документация

Для более подробной информации о настройке и использовании **Primo.ActiveDirectory** посетите [документацию на нашем сайте](https://docs.primo-rpa.ru).

## Состав библиотеки

Библиотека включает в себя следующие возможности:

1. **Соединение с Active Directory**

2. **Компьютеры**:
   - Добавить компьютер в группу
   - Изменить статус компьютера
   - Получить компьютеры группы
   - Получить состояние компьютера
   - Присоединить компьютер к домену
   - Проверка существования компьютера
   - Создать компьютер
   - Удалить компьютер
   - Удалить компьютер из группы
   - Удалить компьютер из домена

3. **Группы**:
   - Добавить группу в группу
   - Проверка существования группы
   - Создать группу
   - Удалить группу
   - Удалить группы из группы

4. **Общие**
   - Изменить свойства объекта
   - Переименовать объект
   - Переместить объект
   - Получить объекты по фильтру
   - Получить объекты по фильтру LDAP
   - Получить свойства объекта
   - Получить уникальное имя
   - Является членом группы

5. **Пользователи**
   - Добавить пользователя к группе
   - Изменить пароль пользователя
   - Изменить статус пользователя
   - Окончание срока действия пароля
   - Окончание срока действия учетной записи
   - Получить группы пользователя
   - Получить пользователей группы
   - Получить состояние пользователя
   - Принудительно сменить пароль
   - Проверить учетные данные
   - Проверка существования пользователя
   - Создать пользователя
   - Удалить пользователя из группы
   - Удалить пользователя
   - Установка окончания срока действия учетной записи
   
Для использования элемента необходимо перетащить его в рабочее поле проекта Primo RPA Studio.

## Примеры использования Primo.ActiveDirectory

На странице [Learning](https://github.com/PrimoRPA/Learning) доступен RPA-проект, обучающий работе с элементами библиотеки:

1. Скачайте архив со всеми обучающими материалами.
2. Распакуйте архив и откройте в Студии проект ActiveDirectoryExamples.
3. Выберите подходящий процесс (файл *.ltw`) для просмотра.

## Общие свойства элементов библиотеки

Раздел **Общие** есть у каждого элемента, в него входят следующие свойства:

- Наименование
- Отключение логирования
- Пауза до/после
- Продолжение при ошибке
- Скриншот завершения
- Скриншот ошибки
- Тайм-аут

С описанием общих свойств можно ознакомиться на нашем сайте [здесь](https://docs.primo-rpa.ru/primo-rpa/primo-rpa-studio/process/elements).

## Соединение с Active Directory

Все перечисленные ниже элементы добавляются в рабочую область внутри элемента **Соединение с Active Directory**. Элемент осуществляет соединение с сервером Active Directory и включает в себя следующие свойства:

1. **Соединение**:
   - Имя пользователя — формат должен быть указан как домен\логин.
   - Пароль
   - Пароль (зашифрованный)
   - Порт
   - Сервер — сервер контроллера домена.
   - Тип — тип подключения (LDAP или LDAPS).

## Раздел "Компьютеры"

### Элемент "Добавить компьютер в группу"

Добавляет компьютер в заданную группу. Включает в себя следующие свойства, обязательные для заполнения:

1. **Компьютер**:
   - Уникальное имя компьютера
   - Уникальное имя группы

### Элемент "Изменить статус компьютера"

Изменяет статус заданного компьютера. Включает в себя следующие свойства:

1. **Компьютер**:
   - Уникальное наименование компьютера
   - Статус — обязательно для заполнения.

### Элемент "Получить компьютеры группы"

Получает список компьютеров заданной группы. Включает в себя следующие свойства:

1. **Вывод**:
   - Компьютеры — уникальные наименования компьютеров.
2. **Компьютер**:
   - Уникальное имя группы

### Элемент "Получить состояние компьютера"

Получает состояние активности указанного компьютера. Включает в себя следующие свойства:

1. **Вывод**:
   - Активный статус — обязательно для заполнения.
2. **Компьютер**:
   - Уникальное имя компьютера — обязательно для заполнения.

### Элемент "Присоединить компьютер к домену"

Присоединяет заданный компьютер к домену. Включает в себя следующие свойства:

1. **Компьютер**:
   - Имя пользователя — пользователь с правами администратора на компьютере, который будет присоединен к домену. Если не указан, будет использована учетная запись робота.
   - Пароль — пароль пользователя.
   - Присоединиться повторно — указывает, нужно ли повторно присоединять компьютер даже если он уже присоединен.
   - Расположение — уникальное имя родительского узла.
   - Создать учетную запись компьютера — указывает, будет ли создаваться учетная запись компьютера в Active Directory.
   - Уникальное имя компьютера — обязательно для заполнения.

### Элемент "Проверка существования компьютера"

Проверяет существование заданного компьютера. Включает в себя следующие свойства:

1. **Вывод**:
   - Результат — компьютер существует.
1. **Компьютер** (обязательно для заполнения):
   - Значение — проверяемое значение.
   - Расположение — расположение Active Directory, где нужно проводить поиск.
   - Фильтр — фильтр проверки:
      - SAM Account name — уникальное имя учетной записи компьютера, под которым он зарегистрирован в Active Directory. 
      - Common Name — общепринятое имя компьютера в Active Directory. Этот фильтр ищет компьютер на основе его общего имени, которое обычно используется для его идентификации в домене.
      - Use Principal name — уникальный идентификатор (например, computer@domain.com). Этот фильтр ищет компьютер по UPN, если он настроен в домене для данного компьютера.

### Элемент "Создать компьютер"

Создает новый компьютер в Active Directory. Включает в себя следующие свойства:

1. **Вывод**:
   - Уникальное имя — уникальное имя созданного компьютера.
2. **Компьютер**:
   - Включен — признак включения нового компьютера.
   - Имя учетной записи SAM — обязательно для заполнения.
   - Общее имя — общее имя нового компьютера. Обязательно для заполнения.
   - Расположение — уникальное имя родительской записи. Обязательно для заполнения.
   - Свойства — свойства компьютера (таблица из двух колонок, где в первой колонке имя свойства, во второй значение).

### Элемент "Удалить компьютер"

Удаляет компьютер. Включает в себя следующие обязательные для заполнения свойства:

1. **Компьютер**:
   - Уникальное имя компьютера
   - Рекурсивно — признак удаления вместе с дочерними элементами.

### Элемент "Удалить компьютер из группы"

Удаляет заданный компьютер из группы. Включает в себя следующие обязательные для заполнения свойства:

1. **Компьютер**:
   - Уникальное имя группы
   - Уникальное имя компьютера

### Элемент "Удалить компьютер из домена"

Удаляет заданный компьютер из домена. Включает в себя следующие свойства:

1. **Компьютер**:
   - Имя пользователя — пользователь с правами администратора на компьютере, который будет отсоединен от домена. Если не указан, будет использована учетная запись робота.
   - Отключить учетную запись компьютера
   - Пароль — пароль пользователя.
   - Уникальное имя компьютера — обязательно для заполнения.

## Раздел "Группы"

### Элемент "Создать группу"

Создает новую группу в Active Directory. Включает в себя следующие свойства:

1. **Вывод**:
   - Уникальное имя — уникальное имя созданной группы.
2. **Группа**:
   - Имя учетной записи SAM — обязательно для заполнения.
   - Общее имя — обязательно для заполнения. Общее имя новой группы.
   - Расположение — уникальное имя родительской записи. Обязательно для заполнения.
   - Свойства — свойства группы (таблица из двух колонок, где в первой колонке имя свойства, во второй значение).
   - Тип — тип группы.

### Элемент "Удалить группу"

Удаляет группу. Включает в себя следующие обязательные для заполнения свойства:

1. **Группа**:
   - Рекурсивно — признак удаления вместе с дочерними элементами.
   - Уникальное имя группы

### Элемент "Добавить группу в группу"

Добавляет группу в заданную группу. Включает в себя следующие обязательные для заполнения свойства:

1. **Группа**:
   - Уникальное имя группы
   - Уникальное имя родительской группы

### Элемент "Проверка существования группы"

Проверяет существования заданной группы. Включает в себя следующие свойства:

1. **Вывод**
   - Результат — группа существует.
2. **Группа** (обязательно для заполнения):
   - Значение — проверяемой значение.
   - Расположение — расположение Active Directory, где нужно проводить поиск
   - Фильтр — фильтр проверки:
      - SAM Account name — уникальное имя учетной записи безопасности (логин), которое используется для идентификации объекта в Active Directory.
      - Common Name — общепринятое имя объекта в Active Directory. Оно может включать как имя группы, так и её описание.
      - Use Principal name — имя пользователя в формате email-адреса (например, user@domain.com). В контексте группы это значение используется для поиска группы по её UPN, если таковой имеется.

### Элемент "Удалить группы из группы"

Удаляет заданную группу из группы. Включает в себя следующие обязательные для заполнения свойства:

1. **Группа**:
   - Уникальное имя группы
   - Уникальное имя родительской группы

## Раздел "Общие"

### Элемент "Изменить свойства объекта"

Редактирует свойства заданного объекта. Включает в себя следующие свойства:

1. **Фильтр**:
   - Новое значение — значение редактируемого свойства.
   - Редактируемое свойство — имя редактируемого свойства.
   - Свойства — массив редактируемых свойств.
   - Свойства (таблица) — массив редактируемых свойств (таблица из двух колонок, где в первой колонке имя свойства, во второй значение).
   - Уникальное имя объекта — обязательно для заполнения.

### Элемент "Переименовать объект"

Осуществляет переименование объекта. Включает в себя следующие свойства:

1. **Фильтр**:
   - Новое имя — новое общее имя (CN) объекта.
   - Уникальное имя объекта — обязательно для заполнения.

### Элемент "Переместить объект"

Перемещает объект в другую группу. Включает в себя следующие свойства:

1. **Фильтр**:
   - Уникальное имя объекта — обязательно для заполнения.
   — Уникальное имя группы — уникальное имя новой родительской группы.

### Элемент "Получить объекты по фильтру"

Осуществляет поиск объектов в соответствии с фильтром. Включает в себя следующие свойства:

1. **Вывод**:
   - Объекты — массив уникальных наименований объектов.
2. **Фильтр**:
   - Значение свойства — обязательно для заполнения.
   - Категория — категория объектов для извлечения (например, лицо - Person).
   - Класс — класс объектов для извлечения (например, группа, пользователь, компьютер и т.д.).
   - Отношение — оператор, который будет использоваться в отношении фильтра:
      - Equal to — равен указанному значению.
      - Not Equal — не равен указанному значению.
      - Greater Than Or Equal To — больше или равно указанному значению.
      - Less Than Or Equal To — меньше или равно указанному значению.
   - Расположение — отличительное имя, идентифицирующее местоположение AD.
   - Свойство — свойство, по которому осуществляется фильтрация. Обязательно для заполнения.

### Элемент "Получить объекты по фильтру LDAP"

Осуществляет поиск объектов по фильтру LDAP. Включает в себя следующие свойства:

1. **Вывод**:
   - Объекты — массив уникальных наименований объектов.
2. **Фильтр**:
   - Расположение — отличительное имя, идентифицирующее местоположение AD.
   - Фильтр — обязательно для заполнения. Фильтр LDAP. Например, для поиска пользователей с cn, начинающимся с `Иван`, используйте фильтр LDAP `(&(objectCategory=person)(objectClass=user)(cn=Иван*))`.

### Элемент "Получить свойства объекта"

Получает свойства заданного объекта. Включает в себя следующие свойства:

1. **Вывод**:
   - Все свойства — все свойства объекта.
   - Значение — значение заданного свойства.
2. **Свойство**:
   - Свойство — имя определенного свойства. Если не указано, будут получены все.
   - Уникальное имя объекта

### Элемент "Получить уникальное имя"

Получает уникальное наименование объекта. Включает в себя следующие свойства:

1. **Вывод**:
   - Уникальное имя
2. **Фильтр**:
   - Имя учетной записи SAM — обязательно для заполнения.

### Элемент "Является членом группы"

Проверяет, является ли объект членом заданной группы. Включает в себя следующие свойства:

1. **Вывод**:
   - Результат — результат проверки.
2. **Фильтр**:
   - Рекурсия в дочерний — признак осуществления проверки в дочерних группах.
   - Уникальное имя группы — уникальное имя проверяемой группы.
   - Уникальное имя объекта — обязательно для заполнения.

## Раздел "Пользователи"

### Элемент "Добавить пользователя к группе"

Добавляет пользователя в заданную группу. Включает в себя следующие обязательные для заполнения свойства:

1. **Пользователь**:
   - Уникальное имя пользователя — уникальное имя учетной записи.
   - Уникальное имя группы

### Элемент "Изменить пароль пользователя"

Изменяет пароль пользователя. Включает в себя следующие обязательные для заполнения свойства:

1. **Пользователь**:
   - Уникальное имя пользователя — уникальное имя учетной записи.
   - Пароль — новый пароль пользователя.

### Элемент "Изменить статус пользователя"

Изменяет статус указанного пользователя. Включает в себя следующие обязательные для заполнения свойства:

1. **Пользователь**:
   - Статус:
      - Disabled — учетная запись будет отключена, пользователь не сможет войти в систему.
      - Enabled — учетная запись будет включена, пользователь сможет получить доступ к системе.
      - Unlocked — учетная запись будет разблокирована, если она была заблокирована из-за неправильного ввода пароля или других причин.
   - Уникальное имя пользователя — уникальное имя учетной записи.

### Элемент "Окончание срока действия пароля"

Получает дату окончания срока действия пароля указанного пользователя. Включает в себя следующие обязательные для заполнения свойства:

1. **Вывод**:
   - Дата — дата окончания срока.
2. **Пользователь**:
   - Уникальное имя пользователя — уникальное имя учетной записи.

### Элемент "Окончание срока действия учетной записи"

Получает дату окончания срока действия учетной записи указанного пользователя. Включает в себя следующие обязательные для заполнения свойства:

1. **Вывод**:
   - Дата — дата окончания срока.
2. **Пользователь**:
   - Уникальное имя пользователя — уникальное имя учетной записи.

### Элемент "Получить группы пользователя"

Получает список групп, в которые входит указанный пользователь. Включает в себя следующие обязательные для заполнения свойства:

1. **Вывод**:
   - Группы — список групп пользователя.
2. **Пользователь**:
   - Уникальное имя пользователя — уникальное имя учетной записи.

### Элемент "Получить пользователей группы"

Получает список пользователей указанной группы. Включает в себя следующие свойства:

1. **Вывод**:
   - Пользователи — уникальные наименования пользователей.
2. **Пользователь**:
   - Уникальное имя группы — обязательно для заполнения.

### Элемент "Получить состояние пользователя"

Получает состояния блокировки и активности указанного пользователя. Включает в себя следующие обязательные для заполнения свойства:

1. **Вывод**:
   - Активный статус
   - Статус блокировки
2. **Пользователь**:
   - Уникальное имя пользователя — уникальное имя учетной записи.

### Элемент "Принудительно сменить пароль"

Вызывает принудительную смену пароля. Включает в себя следующие обязательные для заполнения свойства:

1. **Пользователь**:
   - Уникальное имя пользователя — уникальное имя учетной записи.

### Элемент "Проверить учетные данные"

Проверяет учетные данные указанного пользователя. Включает в себя следующие свойства:

1. **Вывод**:
   - Результат — дата окончания срока.
2. **Пользователь**:
   - Значение — обязательно для заполнения. Значение фильтра.
   - Пароль — пароль пользователя.
   - Пароль (зашифрованный)
   - Фильтр — фильтр пользователя.

### Элемент "Проверка существования пользователя"

Проверяет существование указанного пользователя. Включает в себя следующие свойства:

1. **Вывод**:
   - Результат — пользователь существует.
2. **Пользователь** (обязательны для заполнения):
   - Значение — проверяемое значение.
   - Расположение — расположение Active Directory, где нужно проводить поиск.
   - Фильтр — фильтр проверки.

### Элемент "Создать пользователя"

Создает нового пользователя в Active Directory. Включает в себя следующие свойства:

1. **Вывод**:
   - Уникальное имя — уникальное имя созданного пользователя.
2. **Пользователь**:
   - Включен — признак включения нового пользователя.
   - Имя учетной записи SAM — обязательно для заполнения.
   - Общее имя — обязательно для заполнения.
   - Пароль — обязательно для заполнения.
   - Расположение — обязательно для заполнения. Уникальное имя родительской записи.
   - Свойства — свойства пользователя (таблица из двух колонок, где в первой колонке имя свойства, во второй значение).

### Элемент "Удалить пользователя"

Удаляет пользователя. Включает в себя следующие обязательные для заполнения свойства:

1. **Пользователь**:
   - Уникальное имя пользователя — уникальное имя учетной записи.
   - Рекурсивно — признак удаления вместе с дочерними элементами.

### Элемент "Установка окончания срока действия учетной записи"

Устанавливает срок истечения учетной записи указанного пользователя. Включает в себя следующие обязательные для заполнения свойства:

1. **Пользователь**:
   - Дата — дата окончания срока.
   - Уникальное имя пользователя — уникальное имя учетной записи.

## Обратная связь

Если у вас возникли вопросы или предложения, пожалуйста, свяжитесь с нами по адресу [support@primo-rpa.ru](mailto:support@primo-rpa.ru).
