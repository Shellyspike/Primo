# Primo.Database.SqlServer

**Primo.Database.SqlServer** — это библиотека, предназначенная для упрощения работы с базами данных MS SQL Server в среде Windows. Пакет решает задачи, связанные с выполнением SQL-запросов и управлением подключениями к базе данных, предоставляя разработчикам удобный и интуитивно понятный интерфейс.

## Установка и настройка

Для установки пакета **Primo.Database.SqlServer** воспользуйтесь Менеджером зависимостей Visual Studio или загрузите его с [NuGet.org](https://www.nuget.org/).

### Установка через Менеджер зависимостей:

1. **Откройте Менеджер зависимостей:**
   - В главном меню Primo RPA Studio выберите `Управление зависимостями`.
   - Или щелкните правой кнопкой в панели проекта и выберите в отобразившемся меню пункт «Зависимости».

2. В открывшемся окне перейдите в раздел **NuGet.org** и введите **Primo RPA** в строку поиска.

3. Нажмите на значок с воронкой для отображения списка доступных библиотек. Найдите **Primo.Database.SqlServer** и нажмите **Установить**.

4. Нажмите **Сохранить** для завершения установки. Пакет будет добавлен в ваш проект.

## Документация

Более подробная документация доступна на [сайте Primo RPA](https://docs.primo-rpa.ru).

## Возможности и функции

С помощью элемента "Выполнить запрос к базе данных" библиотека выполняет следующие основные функции:

- **Выполнение SQL-запросов** с поддержкой именованных аргументов через `@Parameter`.
- **Управление подключениями**: возможность использовать существующие подключения или настраивать новые через свойства элементов.

## Состав библиотеки

### Свойства элемента «Выполнить запрос»

1. **База данных**:
   - **Соединение с БД**: Переменная, содержащая инстанс соединения с БД. Свойство заполняется, если вы хотите использовать ранее установленное и активное подключение к БД. Если вы заполнили это свойство, оставьте пустыми свойства Строка соединения и Тип БД.
   - **Строка соединения**: Строка соединения, которая будет использована для установки подключения к базе данных. 

2. **Вывод**:
   - **Кол-во**: Количество обработанных строк.
   - **Переменная (массив)**: Переменная для сохранения результатов запроса в массиве.
   - **Переменная (таблица)**: Переменная для сохранения результатов запроса в `DataTable`.

3. **Данные запроса**:
   - **Аргументы (конструктор)**: Аргументы запроса в строковом формате. Строку можно сформировать в окне мастера по кнопке ![alt text](image-1.png). Пример результата из мастера:
     ```plaintext
     "{\"Args\":[{\"Position\":0,\"Name\":\"@par1\",\"Script\":\"\\\"test\\\"\"}]}"
     ```
   - **Аргументы (массив)**: Аргументы запроса в виде массива.
   - **Наличие результатов**: Признак ожидания результатов запроса. Установите галочку, если запрос должен вернуть данные (например, `SELECT * FROM table`). Если это запрос типа `INSERT INTO` или `DELETE FROM`, который не возвращает данные, галочку ставить не нужно.
   - **Таймаут**: Таймаут запроса в секундах.
   - **Текст запроса**: Текст SQL-запроса. Пример для PostgreSQL:
     ```sql
     "SELECT * FROM table1 WHERE column1 = @par1"
     ```

4. **Общие свойства** (описание общих свойств см. на нашем сайте [здесь](https://docs.primo-rpa.ru/primo-rpa/primo-rpa-studio/process/elements)):
   - **Наименование**
   - **Отключить логирование**
   - **Пауза до (мс)**
   - **Пауза после (мс)**
   - **Продолжить при ошибке**
   - **Скриншот завершения**
   - **Скриншот ошибки**

## Дополнительные материалы

Пример RPA-проекта, демонстрирующий работу библиотеки, доступен в нашем [публичном репозитории](https://github.com/PrimoRPA/Learning).

## Обратная связь

Если у вас возникли вопросы или предложения, пожалуйста, свяжитесь с нами по адресу [support@primo-rpa.ru](mailto:support@primo-rpa.ru).
