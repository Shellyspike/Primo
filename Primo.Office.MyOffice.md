# Описание пакета Primo.Office.MyOffice

Пакет **Primo.Office.MyOffice** предоставляет инструменты для автоматизации работы с документами офисного пакета МойОфис. Он позволяет выполнять действия с текстовыми и табличными документами, включая ввод данных, форматирование и управление структурой документов.

## Общие сведения

**Primo.Office.MyOffice** — это библиотека, предназначенная для взаимодействия с документами в приложениях МойОфис. Пакет поддерживает автоматизацию работы с текстовыми и табличными файлами, предоставляя удобный интерфейс для выполнения различных операций, таких как ввод данных, изменение структуры документа, выполнение макросов и многое другое.

## Инструкции по началу работы

Чтобы установить пакет **Primo.Office.MyOffice**, воспользуйтесь Менеджером зависимостей в Primo RPA Studio или посетите [NuGet.org](https://www.nuget.org/).

### Шаги для установки

1. **Откройте Менеджер зависимостей:**
   - В главном меню Primo RPA Studio выберите `Управление зависимостями`.
   - Или щелкните правой кнопкой в панели проекта и выберите в отобразившемся меню пункт «Зависимости».

2. В открывшемся окне перейдите в раздел **NuGet.org** и введите **Primo RPA** в строку поиска.

3. Нажмите на значок с воронкой для отображения списка доступных библиотек. Найдите **Primo.Office.MyOffice** и нажмите **Установить**.

4. Нажмите **Сохранить**. 

5. В открывшемся модальном окне нажмите **Установить** и затем **Закрыть** для завершения установки. Пакет будет добавлен в ваш проект.

## Документация

Для более подробной информации о настройке и использовании **Primo.Office.MyOffice** посетите [документацию на нашем сайте](https://docs.primo-rpa.ru).

## Состав библиотеки

Библиотека включает в себя следующие возможности:

- **Таблица**:
   - Страницы
      - Добавить страницу
      - Переименовать страницу
      - Список страниц
      - Удалить страницу
   - Ввод в ячейку
   - Вставка колонок
   - Вставка строк
   - Запись диапазона
   - Запустить макрос
   - МойОфис Таблица
   - Сохранить документ
   - Удаление колонок
   - Удаление строк
   - Чтение диапазона

- **Текст**:
  - Ввод текста
  - Вставить таблицу
  - Вставка изображения
  - Добавить строку таблицы
  - Заменить текст
  - Записать в ячейку таблицы
  - МойОфис Текст
  - Прочитать таблицу
  - Сохранить документ
  - Чтение текста
  - Экспортировать документ

Для использования элемента необходимо перетащить его в рабочее поле проекта Primo RPA Studio.

## Примеры использования Primo.Office.MyOffice

### Пример работы с таблицами

```csharp
LTools.Office.MyOfficeTableApp app = LTools.Office.MyOfficeTableApp.Init(wf, fileName);
app.SheetAdd("Page1", 20, 3);
app.WriteCell("A4", "Значение", "Page1");
app.Save();
```

### Пример работы с текстовыми документами

```csharp
LTools.Office.MyOfficeTextApp app = LTools.Office.MyOfficeTextApp.Init(wf, fileName);
app.AppendText("Это пример текста");
app.Save();
```

### Пример изменения существующей таблицы

```csharp
var app = LTools.Office.MyOfficeTableApp.Init(wf, existingFile);
app.SheetSelect("Page1");
app.WriteCell("B2", "Новое значение", "Page1");
app.Save();
```

### Пример добавления страницы в текстовый документ

```csharp
LTools.Office.MyOfficeTextApp app = LTools.Office.MyOfficeTextApp.Init(wf, fileName);
app.AddPage();
app.AppendText("Это текст на новой странице");
app.Save();
```

### Пример создания новой таблицы с заголовками

```csharp
var app = LTools.Office.MyOfficeTableApp.Init(wf, newFile);
app.SheetAdd("Page1", 10, 5);
app.WriteCell("A1", "Заголовок 1", "Page1");
app.WriteCell("B1", "Заголовок 2", "Page1");
app.Save();
```

## Свойства элементов библиотеки

### Общие

Раздел **Общие** есть у каждого элемента, в него входят следующие свойства:

- Наименование
- Отключение логирования
- Пауза до/после
- Продолжение при ошибке
- Скриншот завершения
- Скриншот ошибки
- Тайм-аут

С описанием общих свойств можно ознакомиться на нашем сайте [здесь](https://docs.primo-rpa.ru/primo-rpa/primo-rpa-studio/process/elements).

### Раздел "Таблица"

Все перечисленные ниже элементы добавляются в рабочую область внутри элемента **МойОфис Таблица**. Это элемент для подключения к приложению "МойОфис Таблицы". Если указанный файл отсутствует, будет создан новый. Элемент **МойОфис Таблица** включает в себя следующие свойства:

1. **Таблица**:
   - Кодовая страница — кодовая страница кириллицы.
   - Массив байтов — массив байтов документа.
   - Путь к файлу — по кнопке ![alt text](image-3.png) можно указать путь к файлу в окне Проводника.

---

#### Подраздел "Страницы"

   ##### Добавить страницу
   
   Элемент для добавления новой страницы в Таблицу. Включает в себя следующие свойства:
   
   1. **Таблица**:
      - Имя — имя новой страницы. Обязательно для заполнения.
      - Индекс — индекс страницы.
      - Колонки — количество колонок. Обязательно для заполнения.
      - Строки — количество строк. Обязательно для заполнения.
   
   ##### Переименовать страницу
   
   Элемент для переименования страницы в Таблице. Включает в себя следующие свойства:
   
   1. **Таблица**:
      - Имя — имя страницы.
      - Индекс — индекс страницы.
   
   ##### Список страниц
   
   Элемент для получения списка страниц Таблицы. Включает в себя следующие свойства:
   
   1. **Вывод**:
      - Переменная — переменная для хранения списка страниц.
   
   ##### Удалить страницу
   
   Элемент для удаления страницы из Таблицы. Включает в себя следующие свойства:
   
   1. **Таблица**:
      - Индекс — индекс страницы.
     
---

#### Элемент "Ввод в ячейку"

Производит запись данных в ячейку Таблицы. Включает в себя следующие свойства:

1. **Таблица**:
   - Данные — данные, вводимые в ячейку. Обязательно для заполнения.
   - Индекс страницы
   - Как текст — вставлять значение, как текст.
   - Страница — наименование страницы.
   - Числовой формат — формат вводимого числа (#,#).
   - Ячейка — идентификатор ячейки. Обязательно для заполнения.

#### Элемент "Вставка колонок"

Элемент, вставляющий колонки в лист Таблицы. Включает в себя следующие свойства:

1. **Таблица**:
   - Индекс — индекс колонки, справа от которой будет производиться вставка. Если не указан, то вставка производится в конце листа.
   - Индекс страницы
   - Кол-во — кол-во вставляемых колонок. Обязательно для заполнения.
   - Страница — наименование страницы.

#### Элемент "Вставка строк"

Элемент, вставляющий строки в лист Таблицы. Включает в себя следующие свойства:

1. **Таблица**:
   - Индекс — индекс строки, после которой будет производиться вставка. Если не указан, то вставка производится в конце листа.
   - Индекс страницы
   - Кол-во — кол-во вставляемых строк. Обязательно для заполнения.
   - Страница — наименование страницы.

#### Элемент "Запись диапазона"

Элемент, записывающий данные диапазона ячеек в Таблицу. Включает в себя следующие свойства:

1. **Таблица**:
   - Диапазон — диапазон записи ячеек (A1:D12). Обязательно для заполнения.
   - Добавлять заголовки — добавлять заголовки колонок таблицы.
   - Индекс страницы
   - Как текст — вставлять значение, как текст.
   - Направление — направление сдвига ячеек:
     - Down
     - Right
   - Перезаписать — признак перезаписи данных.
   - Переменная (информация) — переменная для хранения данных информации о ячейках.
   - Переменная (таблица) — переменная для хранения данных текстовых значений.
   - Переменная (текст) — переменная для хранения данных записи текстовых значений.
   - Расширять диапазон — автоматически расширять диапазон до размеров данных.
   - Страница — наименование страницы.
   - Числовой формат — формат вводимого числа (#,#).

#### Элемент "Запустить макрос"

Элемент для выполнения макроса Таблицы. Включает в себя следующие свойства:

1. **Прочие**:
   - Result
2. **Таблица**:
   - Наименование — наименование макроса. Обязательно для заполнения.

#### Элемент "Сохранить документ"

Элемент сохраняет текущее состояние файла таблицы. Если путь к файлу не указан, сохранен будет файл, открытый в рамках текущего контейнера Таблицы. Включает в себя следующие свойства:

1. **Таблица**:
   - Путь к файлу — по кнопке ![alt text](image-3.png) можно указать путь к файлу в окне Проводника.

#### Элемент "Удаление колонок"

Элемент удаляет колонки из листа таблицы. Включает в себя следующие свойства:

1. **Таблица**:
   - Индекс — индекс колонки, которую необходимо удалить.
   - Индекс страницы
   - Кол-во — кол-во удаляемых колонок. Обязательно для заполнения.
   - Страница — наименование страницы.

#### Элемент "Удаление строк"

Элемент удаляет строки из листа таблицы. Включает в себя следующие свойства:

1. **Таблица**:
   - Индекс — индекс строки, которую необходимо удалить.
   - Индекс страницы
   - Кол-во — кол-во удаляемых строк. Обязательно для заполнения.
   - Страница — наименование страницы.

#### Элемент "Чтение диапазона"

Элемент считывает данные из диапазона ячеек таблицы. Включает в себя следующие свойства:

1. **Вывод**:
   - Переменная (информация) — переменная для хранения данных информации о ячейках
   - Переменная (таблица) — переменная для хранения данных текстовых значений
   - Переменная (текст) — переменная для хранения данных записи текстовых значений
   - Строка заголовков — признак того, что первая строка содержит заголовки (для таблицы). Если галочка установлена, то заголовки будут учитываться
2. **Таблица**:
   - Диапазон — диапазон считывания ячеек ("A1:D12"). Если не указан, будет прочитан выделенный диапазон. Если указан символ "*", будет прочитан весь лист.
   - Индекс страницы
   - Страница — наименование страницы

### Раздел "Текст"

Все перечисленные ниже элементы добавляются в рабочую область внутри элемента **МойОфис Текст**. Этот контейнер производит подключение к приложению МойОфис Текст. Если указанный файл отсутствует, будет создан новый. Элемент **МойОфис Текст** включает в себя следующие свойства:

1. **Таблица**:
   - Кодовая страница — кодовая страница кириллицы.
2. **Текст**:
   - Массив байтов — Массив байтов документа.
   - Путь к файлу — по кнопке ![alt text](image-3.png) можно указать путь к файлу в окне Проводника.

#### Элемент "Ввод текста"

Элемент записывает данные в текстовый документ. Включает в себя следующие свойства:

1. **Word**:
   - Закладка — имя закладки, определяющей начало записи. Если не указано, позиция записи определяется свойством Позиция ввода.
2. **Текст**:
   - Позиция ввода — ввод текста в начало/конец. По умолчанию установлено значение End.
   - Текст — обязательно для заполнения.

#### Элемент "Вставить таблицу"

Элемент вставляет таблицу в документ. Включает в себя следующие свойства:

1. **Текст**:
   - Данные — данные таблицы.
   - Закладка — имя закладки, определяющей начало записи. Если не указано, запись производится в конец текста.
   - Таблица — название переменной с табличными данными.

#### Элемент "Вставка изображения"

Элемент вставляет изображения в текстовый документ. Включает в себя следующие свойства:

1. **Текст**:
   - Высота — обязательно для заполнения. Высота изображения. По умолчанию 100.
   - Закладка — имя закладки, определяющей начало записи. Если не указано, запись производится в конец текста.
   - Изображение — обязательно для заполнения. Изображение, которое нужно вставить в документ.
   - Ширина — обязательно для заполнения. Ширина изображения. По умолчанию 100.

#### Элемент "Добавить строку таблицы"

Элемент добавляет строку к таблице. Включает в себя следующие свойства:

1. **Текст**:
   - Данные
   - Индекс — порядковый номер таблицы. Обязательно для заполнения.
   - Строка — данные строки.

#### Элемент "Заменить текст"

Элемент заменяет все вхождения исходного текста на новый. Включает в себя следующие свойства:

1. **Текст**:
   - Исходный текст — текст, который нужно заменить.
   - Новый текст — новый текст для замены. Обязательно для заполнения.

#### Элемент "Записать в ячейку таблицы"

Элемент записывает текст в ячейку таблицы. Включает в себя следующие свойства:

1. **Текст**:
   - Данные — данные ячейки.
   - Индекс — обязательно для заполнения. Порядковый номер таблицы.
   - Колонка — порядковый номер колонки.
   - Строка — порядковый номер строки.

#### Элемент "Прочитать таблицу"

Элемент читает таблицу из текстового документа. Включает в себя следующие свойства:

1. **Вывод**:
   - Данные — название переменной, в которую будут сохранены двумерный список текстовых данных.
   - Таблица — название переменной, в которую будут сохранены табличные данные.
2. **Текст**:
   - Индекс — обязательно для заполнения. Порядковый номер таблицы.

#### Элемент "Сохранить документ"

Элемент сохраняет текущее состояние текстового файла. Включает в себя следующие свойства:

1. **Текст**:
   - Путь к файлу — по кнопке ![alt text](image-3.png) можно указать путь к файлу в окне Проводника.

#### Элемент "Чтение текста"

Элемент считывает данные из текстового документа. Включает в себя следующие свойства:

1. **Вывод**:
   - Переменная — переменная для хранения результатов чтения. Обязательно для заполнения.

#### Элемент "Экспортировать документ"

Элемент производит экспорт текстового документа в другой формат. Включает в себя следующие свойства:

1. **Word**:
   - Путь к файлу — путь к экспортированному файлу (например, c:\folder\files.pdf).
   - Формат — тип формата. В настоящее время доступен только формат Pdf.

## Обратная связь

Если у вас возникли вопросы или предложения, пожалуйста, свяжитесь с нами по адресу [support@primo-rpa.ru](mailto:support@primo-rpa.ru).
