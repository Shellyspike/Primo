# Описание пакета Primo.Networking

Пакет **Primo.Networking** предоставляет мощный набор инструментов для работы с HTTP и SOAP запросами. Этот пакет особенно полезен для разработчиков, работающих с интеграцией внешних сервисов и автоматизацией процессов.

## Общие сведения

**Primo.Networking** представляет собой комплексный набор элементов, предназначенных для выполнения HTTP и SOAP запросов. Он позволяет легко настроить запросы, управлять аутентификацией, а также получать и обрабатывать ответы.

## Инструкции по началу работы

Чтобы установить пакет **Primo.Networking**, воспользуйтесь Менеджером зависимостей в Primo RPA Studio или посетите [NuGet.org](https://www.nuget.org/).

### Шаги для установки

1. **Откройте Менеджер зависимостей:**
   - В главном меню Primo RPA Studio выберите `Управление зависимостями`.
   - Или щелкните правой кнопкой в панели проекта и выберите в отобразившемся меню пункт «Зависимости».

2. В открывшемся окне перейдите в раздел **NuGet.org** и введите **Primo RPA** в строку поиска.

3. Нажмите на значок с воронкой для отображения списка доступных библиотек. Найдите **Primo.Networking** и нажмите **Установить**.

4. Нажмите **Сохранить** для завершения установки. Пакет будет добавлен в ваш проект.

## Документация

Для более подробной информации о настройке и использовании **Primo.Networking** посетите [документацию на нашем сайте](https://docs.primo-rpa.ru).

## Состав библиотеки
Библиотека включает в себя следующие возможности:
- Запрос HTTP.
- Запрос SOAP.

Для использования элемента необходимо перетащить его в рабочее поле проекта Primo RPA Studio.

### Свойства элементов библиотеки

#### HTTP запрос

1. Элемент включает в себя следующие свойства:
   - **OAuth1**:
     - Consumer key
     - Consumer secret
     - OAuth1 secret
     - OAuth1 token
   - **OAuth2**:
     - OAuth2 token
   - **Аутентификация сертификата клиента**:
     - Зашифрованный пароль - Зашифрованный пароль сертификата. Пароль, зашифрованный с помощью SecureString, не хранится в   открытом виде. Получить его можно, к примеру, из программы "Диспетчер учетных данных" (Credential Manager).
     - Пароль сертификата
     - Проверка SSL - Установите отметку, если нужно включить проверку сертификата SSL.
     - Сертификат клиента
   - **Ввод**:
     - URL - обязательно для заполнения. URL-адрес, на который сделан запрос.
     - Метод - Выберите метод запроса. По умолчанию GET.
     - Формат - Выберите формат ответа, требуемый от сервера. По умолчанию установлен ANY - любой формат.
   - **Вывод**:
     - Заголовки - Заголовки ответа.
     - Контент - Контент ответа сервера.
     - Статус - Статус ответа сервера.
   - **Общие** - описание общих свойств см. на нашем сайте [здесь](https://docs.primo-rpa.ru/primo-rpa/primo-rpa-studio/process/elements):
     - Наименование
     - Отключение логирования
     - Пауза до/после
     - Продолжение при ошибке
     - Скриншот завершения
     - Скриншот ошибки
     - Тайм-аут
   - **Параметры**:
     - Cookies
     - Вложения - Массив путей файлов для загрузки в запрос.
     - Заголовки - Заголовки запроса.
     - Параметры - Параметры запроса.
     - Путь к ресурсу - Путь сохранения файла, полученного от запроса.
     - Сегменты URL - Словарь сегментов, добавляемых к URL. Задаются в формате "{key}".
     - Тело - Тело запроса. Обращаем внимание, что кавычки в теле запроса необходимо экранировать с помощью символа `\`. Пример экранирования для формата json: `"{\"title\":\"MyTitle\"}"`.
     - Формат - Задайте формат тела. По умолчанию используется XML.
   - **Простая проверка подлинности**:
     - Зашифрованный пароль
     - Логин
     - Пароль - Зашифрованный с помощью SecureString пароль.

2. **Решение проблем при настройке запроса HTTP:**
   - Сообщение «Время ожидания операции истекло» может указывать на неверно установленный таймаут.
   - Сообщение «Невозможно соединиться с удаленным сервером» может быть связано с системными ограничениями ОС.

#### SOAP запрос

1. При перетаскивании элемента «Запрос SOAP» в рабочее поле проекта на панели элемента отображается кнопка «Мастер». Нажав на кнопку, в панели "Мастер" можно указать следующие настройки:
   - **Описание сервиса** (URL схемы WSDL).
   - **Получить** (извлечение информации из файла WSDL).
   - **Контракт и Метод** (настройка методов SOAP).
   - **Аутентификация**:
     - None (по умолчанию аутентификация не требуется)
     - Simple (SOAP-сервис требует простую аутентификацию по логину и паролю)
     - Windows (Windows-аутентификация)
     - Client Certificate (аутентификация по сертификату клиента)
   - **Параметры метода**:
     - Наименование
     - Тип
     - Значение
     - Выполнить (кнопка для выполнения запроса)

2. Элемент включает в себя следующие свойства:

  - **Simple** - параметры для типа аутентификации Simple:
    - Защищенный пароль - при использовании зашифрованного пароля укажите его в этом поле в виде переменной SecureString. Такой пароль не хранится в открытом виде в памяти компьютера. Получить его можно, например, из Диспетчера учетных данных (Credential Manager).
    - Логин
    - Пароль
  - **SOAP**:
    - Contract — обязательно для заполнения. Контракт сервиса.
    - Endpoint — обязательно для заполнения. Укажите расположение схемы WSDL.
    - Метод — обязательно для заполнения. Имя метода.
    - Параметры — массив параметров метода. **Важно!** В типах данных классы не поддерживаются, только простые типы.
    - Тайм-аут — тайм-аут запроса в миллисекундах. Укажите максимальное время ожидания ответа от сервера в мс, по истечении которого при отсутствии отклика обращение будет прервано со статусом ошибки. По умолчанию 20000.
  - **Аутентификация**:
    - Аутентификация — выберите из раскрывающегося списка тип аутентификации. Доступные значения: 
      1) None — по умолчанию аутентификация не требуется; 
      2) Simple — простая аутентификация по логину и паролю; 
      3) Windows — используются учетные данные Windows; 
      4) Client Certificate - сертификат клиента.
  - **Вывод**:
    - Заголовки — заголовки ответа, полученного на запрос SOAP.
    - Ответ — ответ сервиса.
  - **Общие** — описание общих свойств см. на нашем сайте [здесь](https://docs.primo-rpa.ru/primo-rpa/primo-rpa-studio/process/elements):
    - Наименование
    - Отключение логирования
    - Пауза до/после
    - Продолжение при ошибке
    - Скриншот завершения
    - Скриншот ошибки
    - Тайм-аут
  - **Сертификат** — параметры для типа аутентификации Client Certific:
    - Защищенный пароль — при использовании зашифрованного пароля сертификата укажите его в этом поле в виде переменной SecureString.
    - Пароль сертификата — укажите пароль сертификата.
    - Сертификат — укажите путь к файлу сертификата либо Subject в хранилище Root.


## Обратная связь

Если у вас возникли вопросы или предложения, пожалуйста, свяжитесь с нами по адресу [support@primo-rpa.ru](mailto:support@primo-rpa.ru).
