# Описание пакета Primo.Office.Pdf

Пакет **Primo.Office.Pdf** предоставляет набор элементов для работы с PDF, включая получение данных из XFA-форм и извлечение таблиц, содержащихся в документе PDF.

## Общие сведения

**Primo.Office.Pdf** представляет собой мощный инструмент для работы с PDF-документами в среде автоматизации Primo RPA Studio. Библиотека предлагает удобные элементы для извлечения данных из сложных PDF-форматов, таких как XFA-формы, а также для быстрого и точного извлечения табличных данных.

## Инструкции по началу работы

Чтобы установить пакет **Primo.Office.Pdf**, воспользуйтесь Менеджером зависимостей в Primo RPA Studio или посетите [NuGet.org](https://www.nuget.org/).

### Шаги для установки

1. **Откройте Менеджер зависимостей:**
   - В главном меню Primo RPA Studio выберите `Управление зависимостями`.
   - Либо щелкните правой кнопкой мыши в панели проекта и выберите в появившемся меню пункт «Зависимости».

2. В открывшемся окне перейдите в раздел **NuGet.org** и введите **Primo.Office.Pdf** в строку поиска.

3. Нажмите на значок фильтра для отображения списка доступных библиотек. Найдите **Primo.Office.Pdf** и нажмите **Установить**.

4. Нажмите **Сохранить**. 

5. В открывшемся модальном окне нажмите **Установить**, а затем **Закрыть** для завершения установки. Пакет будет добавлен в ваш проект.

## Документация

Для более подробной информации о настройке и использовании **Primo.Office.Pdf** посетите [документацию на нашем сайте](https://docs.primo-rpa.ru).

## Состав библиотеки

Библиотека включает в себя следующие возможности:

- **Получение XFA-форм** — извлекает данные из XFA-форм в PDF-документе. XFA-формы представляют собой интерактивные веб-формы, которые можно сохранить в формате PDF.
- **Чтение таблиц** — извлекает табличные данные из PDF-документов. Использование элемента значительно ускоряет и упрощает процессы обработки данных, минимизируя необходимость в ручном вводе. Он обеспечивает высокую точность при извлечении данных, что помогает избежать ошибок, связанных с ручным копированием информации.

Для использования элемента необходимо перетащить его в рабочее поле проекта Primo RPA Studio.

### Свойства элементов библиотеки

#### Общие

Раздел **Общие** присутствует у каждого элемента библиотеки и включает следующие свойства:

- **Наименование** — имя элемента.
- **Отключение логирования** — настройка, отключающая ведение журнала для элемента.
- **Пауза до/после** — задержка выполнения до или после действия.
- **Продолжение при ошибке** — позволяет продолжить выполнение процесса при возникновении ошибки.
- **Скриншот завершения** — создание скриншота после выполнения действия.
- **Скриншот ошибки** — создание скриншота при возникновении ошибки.
- **Тайм-аут** — максимальное время ожидания выполнения действия.

Подробнее ознакомиться с описанием общих свойств можно на нашем сайте [здесь](https://docs.primo-rpa.ru/primo-rpa/primo-rpa-studio/process/elements).

#### Получить форму XFA

Формы XFA — это интерактивные веб-формы, которые можно сохранить в формате PDF. Отличительные характеристики XFA форм:

- XFA основан на XML и использует отдельную XML-структуру для определения элементов формы и их поведения.
- XFA отделяет данные от шаблона, что позволяет упаковывать данные отдельно от формы.
- XFA может задавать динамически растущие формы.

Элемент включает в себя следующие свойства:

1. **PDF**:
   - **Защищенный пароль** — безопасный способ предоставления пароля для доступа к PDF-документу.
   - **Пароль** — пароль для доступа к защищенному PDF-документу.
   - **Путь к файлу** — путь к PDF-файлу. Пример: `"C:\\Users\\user\\Documents\\test.pdf"`. Нажав на кнопку ![alt text](image-4.png), можно указать путь к файлу в Проводнике.
   - **Ядро** — компонент для обработки PDF-файла. Доступные значения:
      - **Spire** — компонент по умолчанию, не требует установки Adobe Acrobat. Поддерживает обработку PDF-документов без ограничения по количеству страниц и позволяет извлекать формы, изображения, текст, страницы и вложения с высокой скоростью и точностью.
      - **Aspose** — компонент для обработки и анализа PDF-документов без установки Adobe Acrobat. Поддерживает работу со страницами, формами, текстом, изображениями и другими объектами. Имеет ограничение: документ должен быть не более 3-х страниц.
2. **Вывод**:
   - **Форма** — переменная для записи данных из XFA-формы.

Пример использования элемента в процессе с типом "Только код" (Pure code):

- C# : `Primo.Office.Pdf.GetXfaForm.GetTable(wf, "Путь к файлу", "Пароль");`
- Python: `Primo.Office.Pdf.GetXfaForm.GetTable(wf, "Путь к файлу", "Пароль")`
- JavaScript: `_lib.Primo.Office.Pdf.GetXfaForm.GetTable(wf, "Путь к файлу", "Пароль");`

#### Чтение таблицы

Элемент предназначен для автоматического извлечения табличных данных из PDF-документов. Он обеспечивает быстрый и точный способ чтения таблиц со страниц PDF, что особенно полезно при обработке большого количества документов или при интеграции данных из PDF в другие системы и приложения.

Элемент включает в себя следующие свойства:

1. **PDF**:
   - **Заголовки** — указывает на наличие заголовков в таблице.
   - **Защищенный пароль** — безопасный способ предоставления пароля для доступа к PDF-документу.
   - **Индекс** — индекс таблицы на странице, если страница содержит несколько таблиц. Нумерация начинается с нуля.
   - **Пароль** — пароль для доступа к защищенному PDF-документу.
   - **Путь к файлу** — путь к PDF-файлу. Пример: `"C:\\Users\\user\\Documents\\test.pdf"`. Нажав на кнопку ![alt text](image-4.png), можно указать путь к файлу в Проводнике.
   - **Страница** — номер страницы PDF-документа, на которой находится таблица. Нумерация начинается с нуля.
   - **Ядро** — компонент для обработки PDF-файла. Доступные значения:
      - **Spire** — компонент по умолчанию, не требует установки Adobe Acrobat. Поддерживает обработку PDF-документов без ограничения по количеству страниц и позволяет извлекать формы, изображения, текст, страницы и вложения с высокой скоростью и точностью.
      - **Aspose** — компонент для обработки и анализа PDF-документов без установки Adobe Acrobat. Поддерживает работу со страницами, формами, текстом, изображениями и другими объектами. Имеет ограничение: документ должен быть не более 3-х страниц.
2. **Вывод**:
   - **Переменная** — переменная для хранения данных, извлеченных из таблицы PDF-документа.

Пример использования элемента в процессе с типом "Только код" (Pure code):

- C# : `Primo.Office.Pdf.PdfApp.GetTable(wf, "Путь к файлу", "Индекс", "Страница", "Заголовки", "Пароль");`
- Python: `Primo.Office.Pdf.PdfApp.GetTable(wf, "Путь к файлу", "Индекс", "Страница", "Заголовки", "Пароль");`
- JavaScript: `_lib.Primo.Office.Pdf.PdfApp.GetTable(wf, "Путь к файлу", "Индекс", "Страница", "Заголовки", "Пароль");`

### Возможные ошибки

При работе с элементом **Чтение таблицы** могут возникнуть следующие ошибки:

- **Ошибка чтения файла**: Если путь к файлу указан неверно или файл не доступен, может возникнуть ошибка чтения файла. Убедитесь, что путь к файлу корректен и файл доступен для чтения.
- **Проблемы с паролем**: Если PDF-файл защищен паролем, неправильный пароль может вызвать ошибку доступа. Убедитесь, что пароль правильный и корректно передается в компонент.

## Обратная связь

Если у вас возникли вопросы или предложения, пожалуйста, свяжитесь с нами по адресу [support@primo-rpa.ru](mailto:support@primo-ru)
